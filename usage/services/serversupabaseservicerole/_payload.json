[{"data":1,"prerenderedAt":613},["ShallowReactive",2],{"navigation":3,"/usage/services/serversupabaseservicerole":58,"/usage/services/serversupabaseservicerole-surround":608},[4,8,12,46,50,54],{"title":5,"_path":6,"icon":7},"Get Started","/get-started","i-heroicons-rocket-launch",{"title":9,"_path":10,"icon":11},"Authentication","/authentication","i-heroicons-lock-closed",{"title":13,"_path":14,"children":15,"icon":45},"Usage","/usage",[16,29],{"title":17,"_path":18,"children":19},"Vue composables","/usage/composables",[20,23,26],{"title":21,"_path":22},"useSupabaseClient","/usage/composables/usesupabaseclient",{"title":24,"_path":25},"useSupabaseSession","/usage/composables/usesupabasesession",{"title":27,"_path":28},"useSupabaseUser","/usage/composables/usesupabaseuser",{"title":30,"_path":31,"children":32},"Server services","/usage/services",[33,36,39,42],{"title":34,"_path":35},"serverSupabaseClient","/usage/services/serversupabaseclient",{"title":37,"_path":38},"serverSupabaseServiceRole","/usage/services/serversupabaseservicerole",{"title":40,"_path":41},"serverSupabaseSession","/usage/services/serversupabasesession",{"title":43,"_path":44},"serverSupabaseUser","/usage/services/serversupabaseuser","heroicons:book-open",{"title":47,"_path":48,"icon":49},"Demo","/demo","i-heroicons-computer-desktop-20-solid",{"title":51,"_path":52,"icon":53},"Changelog","/changelog","i-heroicons-bookmark",{"title":55,"_path":56,"icon":57},"Roadmap","/roadmap","i-heroicons-map",{"_path":38,"_dir":59,"_draft":60,"_partial":60,"_locale":61,"title":62,"description":63,"navigation":64,"body":65,"_type":602,"_id":603,"_source":604,"_file":605,"_stem":606,"_extension":607},"services",false,"","serverServiceRole","Make requests with super admin rights to the Supabase API with the serverSupabaseServiceRole service",{"title":37},{"type":66,"children":67,"toc":600},"root",[68,93,107,127,161,180,484,489,594],{"type":69,"tag":70,"props":71,"children":74},"element","callout",{"color":72,"icon":73},"amber","i-heroicons-exclamation-triangle-20-solid",[75],{"type":69,"tag":76,"props":77,"children":78},"p",{},[79,82,91],{"type":80,"value":81},"text","This section assumes you're familiar with ",{"type":69,"tag":83,"props":84,"children":88},"a",{"href":85,"rel":86},"https://v3.nuxtjs.org/guide/concepts/server-engine",[87],"nofollow",[89],{"type":80,"value":90},"Nitro",{"type":80,"value":92},", the server engine powered by Nuxt.",{"type":69,"tag":76,"props":94,"children":95},{},[96,98,105],{"type":80,"value":97},"This function is designed to work only in ",{"type":69,"tag":83,"props":99,"children":102},{"href":100,"rel":101},"https://nuxt.com/docs/guide/directory-structure/server#server-routes",[87],[103],{"type":80,"value":104},"server routes",{"type":80,"value":106},", there is no vue composable equivalent.",{"type":69,"tag":76,"props":108,"children":109},{},[110,112,116,118,125],{"type":80,"value":111},"It works similary as the ",{"type":69,"tag":83,"props":113,"children":114},{"href":35},[115],{"type":80,"value":34},{"type":80,"value":117}," but it provides a client with super admin rights that can bypass your ",{"type":69,"tag":83,"props":119,"children":122},{"href":120,"rel":121},"https://supabase.com/docs/guides/auth/row-level-security",[87],[123],{"type":80,"value":124},"Row Level Security",{"type":80,"value":126},".",{"type":69,"tag":128,"props":129,"children":130},"blockquote",{},[131],{"type":69,"tag":76,"props":132,"children":133},{},[134,136,143,145,151,153,160],{"type":80,"value":135},"The client is initialized with the ",{"type":69,"tag":137,"props":138,"children":140},"code",{"className":139},[],[141],{"type":80,"value":142},"SUPABASE_SERVICE_KEY",{"type":80,"value":144}," you must have in your ",{"type":69,"tag":137,"props":146,"children":148},{"className":147},[],[149],{"type":80,"value":150},".env",{"type":80,"value":152}," file. Checkout the doc if you want to know more about ",{"type":69,"tag":83,"props":154,"children":157},{"href":155,"rel":156},"https://supabase.com/docs/learn/auth-deep-dive/auth-deep-dive-jwts#jwts-in-supabase",[87],[158],{"type":80,"value":159},"Supabase keys",{"type":80,"value":126},{"type":69,"tag":76,"props":162,"children":163},{},[164,166,171,173,179],{"type":80,"value":165},"Define your server route and just import the ",{"type":69,"tag":137,"props":167,"children":169},{"className":168},[],[170],{"type":80,"value":37},{"type":80,"value":172}," from ",{"type":69,"tag":137,"props":174,"children":176},{"className":175},[],[177],{"type":80,"value":178},"#supabase/server",{"type":80,"value":126},{"type":69,"tag":181,"props":182,"children":187},"pre",{"className":183,"code":184,"filename":185,"language":186,"meta":61,"style":61},"language-ts shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","import { serverSupabaseServiceRole } from '#supabase/server'\n\nexport default eventHandler(async (event) => {\n  const client = serverSupabaseServiceRole(event)\n\n  const { data } = await client.from('rls-protected-table').select()\n\n  return { sensitiveData: data }\n})\n","server/api/bypass-rls.ts","ts",[188],{"type":69,"tag":137,"props":189,"children":190},{"__ignoreMap":61},[191,240,250,307,344,352,431,439,471],{"type":69,"tag":192,"props":193,"children":196},"span",{"class":194,"line":195},"line",1,[197,203,209,215,220,225,230,235],{"type":69,"tag":192,"props":198,"children":200},{"style":199},"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic",[201],{"type":80,"value":202},"import",{"type":69,"tag":192,"props":204,"children":206},{"style":205},"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF",[207],{"type":80,"value":208}," {",{"type":69,"tag":192,"props":210,"children":212},{"style":211},"--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8",[213],{"type":80,"value":214}," serverSupabaseServiceRole",{"type":69,"tag":192,"props":216,"children":217},{"style":205},[218],{"type":80,"value":219}," }",{"type":69,"tag":192,"props":221,"children":222},{"style":199},[223],{"type":80,"value":224}," from",{"type":69,"tag":192,"props":226,"children":227},{"style":205},[228],{"type":80,"value":229}," '",{"type":69,"tag":192,"props":231,"children":233},{"style":232},"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D",[234],{"type":80,"value":178},{"type":69,"tag":192,"props":236,"children":237},{"style":205},[238],{"type":80,"value":239},"'\n",{"type":69,"tag":192,"props":241,"children":243},{"class":194,"line":242},2,[244],{"type":69,"tag":192,"props":245,"children":247},{"emptyLinePlaceholder":246},true,[248],{"type":80,"value":249},"\n",{"type":69,"tag":192,"props":251,"children":253},{"class":194,"line":252},3,[254,259,264,270,275,281,286,292,297,302],{"type":69,"tag":192,"props":255,"children":256},{"style":199},[257],{"type":80,"value":258},"export",{"type":69,"tag":192,"props":260,"children":261},{"style":199},[262],{"type":80,"value":263}," default",{"type":69,"tag":192,"props":265,"children":267},{"style":266},"--shiki-light:#6182B8;--shiki-default:#82AAFF;--shiki-dark:#82AAFF",[268],{"type":80,"value":269}," eventHandler",{"type":69,"tag":192,"props":271,"children":272},{"style":211},[273],{"type":80,"value":274},"(",{"type":69,"tag":192,"props":276,"children":278},{"style":277},"--shiki-light:#9C3EDA;--shiki-default:#C792EA;--shiki-dark:#C792EA",[279],{"type":80,"value":280},"async",{"type":69,"tag":192,"props":282,"children":283},{"style":205},[284],{"type":80,"value":285}," (",{"type":69,"tag":192,"props":287,"children":289},{"style":288},"--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic",[290],{"type":80,"value":291},"event",{"type":69,"tag":192,"props":293,"children":294},{"style":205},[295],{"type":80,"value":296},")",{"type":69,"tag":192,"props":298,"children":299},{"style":277},[300],{"type":80,"value":301}," =>",{"type":69,"tag":192,"props":303,"children":304},{"style":205},[305],{"type":80,"value":306}," {\n",{"type":69,"tag":192,"props":308,"children":310},{"class":194,"line":309},4,[311,316,321,326,330,335,339],{"type":69,"tag":192,"props":312,"children":313},{"style":277},[314],{"type":80,"value":315},"  const",{"type":69,"tag":192,"props":317,"children":318},{"style":211},[319],{"type":80,"value":320}," client",{"type":69,"tag":192,"props":322,"children":323},{"style":205},[324],{"type":80,"value":325}," =",{"type":69,"tag":192,"props":327,"children":328},{"style":266},[329],{"type":80,"value":214},{"type":69,"tag":192,"props":331,"children":333},{"style":332},"--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178",[334],{"type":80,"value":274},{"type":69,"tag":192,"props":336,"children":337},{"style":211},[338],{"type":80,"value":291},{"type":69,"tag":192,"props":340,"children":341},{"style":332},[342],{"type":80,"value":343},")\n",{"type":69,"tag":192,"props":345,"children":347},{"class":194,"line":346},5,[348],{"type":69,"tag":192,"props":349,"children":350},{"emptyLinePlaceholder":246},[351],{"type":80,"value":249},{"type":69,"tag":192,"props":353,"children":355},{"class":194,"line":354},6,[356,360,364,369,373,377,382,386,390,395,399,404,409,413,417,421,426],{"type":69,"tag":192,"props":357,"children":358},{"style":277},[359],{"type":80,"value":315},{"type":69,"tag":192,"props":361,"children":362},{"style":205},[363],{"type":80,"value":208},{"type":69,"tag":192,"props":365,"children":366},{"style":211},[367],{"type":80,"value":368}," data",{"type":69,"tag":192,"props":370,"children":371},{"style":205},[372],{"type":80,"value":219},{"type":69,"tag":192,"props":374,"children":375},{"style":205},[376],{"type":80,"value":325},{"type":69,"tag":192,"props":378,"children":379},{"style":199},[380],{"type":80,"value":381}," await",{"type":69,"tag":192,"props":383,"children":384},{"style":211},[385],{"type":80,"value":320},{"type":69,"tag":192,"props":387,"children":388},{"style":205},[389],{"type":80,"value":126},{"type":69,"tag":192,"props":391,"children":392},{"style":266},[393],{"type":80,"value":394},"from",{"type":69,"tag":192,"props":396,"children":397},{"style":332},[398],{"type":80,"value":274},{"type":69,"tag":192,"props":400,"children":401},{"style":205},[402],{"type":80,"value":403},"'",{"type":69,"tag":192,"props":405,"children":406},{"style":232},[407],{"type":80,"value":408},"rls-protected-table",{"type":69,"tag":192,"props":410,"children":411},{"style":205},[412],{"type":80,"value":403},{"type":69,"tag":192,"props":414,"children":415},{"style":332},[416],{"type":80,"value":296},{"type":69,"tag":192,"props":418,"children":419},{"style":205},[420],{"type":80,"value":126},{"type":69,"tag":192,"props":422,"children":423},{"style":266},[424],{"type":80,"value":425},"select",{"type":69,"tag":192,"props":427,"children":428},{"style":332},[429],{"type":80,"value":430},"()\n",{"type":69,"tag":192,"props":432,"children":434},{"class":194,"line":433},7,[435],{"type":69,"tag":192,"props":436,"children":437},{"emptyLinePlaceholder":246},[438],{"type":80,"value":249},{"type":69,"tag":192,"props":440,"children":442},{"class":194,"line":441},8,[443,448,452,457,462,466],{"type":69,"tag":192,"props":444,"children":445},{"style":199},[446],{"type":80,"value":447},"  return",{"type":69,"tag":192,"props":449,"children":450},{"style":205},[451],{"type":80,"value":208},{"type":69,"tag":192,"props":453,"children":454},{"style":332},[455],{"type":80,"value":456}," sensitiveData",{"type":69,"tag":192,"props":458,"children":459},{"style":205},[460],{"type":80,"value":461},":",{"type":69,"tag":192,"props":463,"children":464},{"style":211},[465],{"type":80,"value":368},{"type":69,"tag":192,"props":467,"children":468},{"style":205},[469],{"type":80,"value":470}," }\n",{"type":69,"tag":192,"props":472,"children":474},{"class":194,"line":473},9,[475,480],{"type":69,"tag":192,"props":476,"children":477},{"style":205},[478],{"type":80,"value":479},"}",{"type":69,"tag":192,"props":481,"children":482},{"style":211},[483],{"type":80,"value":343},{"type":69,"tag":76,"props":485,"children":486},{},[487],{"type":80,"value":488},"Then call your API route from any vue file:",{"type":69,"tag":181,"props":490,"children":493},{"className":183,"code":491,"filename":492,"language":186,"meta":61,"style":61},"const fetchSensitiveData = async () => {\n  const { sensitiveData } = await useFetch('/api/bypass-rls')\n}\n","pages/index.vue",[494],{"type":69,"tag":137,"props":495,"children":496},{"__ignoreMap":61},[497,533,586],{"type":69,"tag":192,"props":498,"children":499},{"class":194,"line":195},[500,505,510,515,520,525,529],{"type":69,"tag":192,"props":501,"children":502},{"style":277},[503],{"type":80,"value":504},"const",{"type":69,"tag":192,"props":506,"children":507},{"style":211},[508],{"type":80,"value":509}," fetchSensitiveData ",{"type":69,"tag":192,"props":511,"children":512},{"style":205},[513],{"type":80,"value":514},"=",{"type":69,"tag":192,"props":516,"children":517},{"style":277},[518],{"type":80,"value":519}," async",{"type":69,"tag":192,"props":521,"children":522},{"style":205},[523],{"type":80,"value":524}," ()",{"type":69,"tag":192,"props":526,"children":527},{"style":277},[528],{"type":80,"value":301},{"type":69,"tag":192,"props":530,"children":531},{"style":205},[532],{"type":80,"value":306},{"type":69,"tag":192,"props":534,"children":535},{"class":194,"line":242},[536,540,544,548,552,556,560,565,569,573,578,582],{"type":69,"tag":192,"props":537,"children":538},{"style":277},[539],{"type":80,"value":315},{"type":69,"tag":192,"props":541,"children":542},{"style":205},[543],{"type":80,"value":208},{"type":69,"tag":192,"props":545,"children":546},{"style":211},[547],{"type":80,"value":456},{"type":69,"tag":192,"props":549,"children":550},{"style":205},[551],{"type":80,"value":219},{"type":69,"tag":192,"props":553,"children":554},{"style":205},[555],{"type":80,"value":325},{"type":69,"tag":192,"props":557,"children":558},{"style":199},[559],{"type":80,"value":381},{"type":69,"tag":192,"props":561,"children":562},{"style":266},[563],{"type":80,"value":564}," useFetch",{"type":69,"tag":192,"props":566,"children":567},{"style":332},[568],{"type":80,"value":274},{"type":69,"tag":192,"props":570,"children":571},{"style":205},[572],{"type":80,"value":403},{"type":69,"tag":192,"props":574,"children":575},{"style":232},[576],{"type":80,"value":577},"/api/bypass-rls",{"type":69,"tag":192,"props":579,"children":580},{"style":205},[581],{"type":80,"value":403},{"type":69,"tag":192,"props":583,"children":584},{"style":332},[585],{"type":80,"value":343},{"type":69,"tag":192,"props":587,"children":588},{"class":194,"line":252},[589],{"type":69,"tag":192,"props":590,"children":591},{"style":205},[592],{"type":80,"value":593},"}\n",{"type":69,"tag":595,"props":596,"children":597},"style",{},[598],{"type":80,"value":599},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":61,"searchDepth":242,"depth":242,"links":601},[],"markdown","content:4.usage:services:2.serverSupabaseServiceRole.md","content","4.usage/services/2.serverSupabaseServiceRole.md","4.usage/services/2.serverSupabaseServiceRole","md",[609,611],{"_path":35,"title":34,"description":610},"Make requests to the Supabase API on server side with the serverSupabaseClient service",{"_path":41,"title":40,"description":612},"Get your Supabase user's session from serverside with the serverSupabaseUser service",1721029871143]